#!/bin/bash
if [ $# -ne 1 ]
then
    echo "$0 <file>"
    exit 1
fi
capabilities="CAP_AUDIT_CONTROL"
capabilities="${capabilities},CAP_AUDIT_READ"
capabilities="${capabilities},CAP_AUDIT_WRITE"
capabilities="${capabilities},CAP_BLOCK_SUSPEND"
capabilities="${capabilities},CAP_CHOWN"
capabilities="${capabilities},CAP_DAC_OVERRIDE"
capabilities="${capabilities},CAP_DAC_READ_SEARCH"
capabilities="${capabilities},CAP_FOWNER"
capabilities="${capabilities},CAP_FSETID"
capabilities="${capabilities},CAP_IPC_LOCK"
capabilities="${capabilities},CAP_IPC_OWNER"
capabilities="${capabilities},CAP_KILL"
capabilities="${capabilities},CAP_LEASE"
capabilities="${capabilities},CAP_LINUX_IMMUTABLE"
capabilities="${capabilities},CAP_MAC_ADMIN"
capabilities="${capabilities},CAP_MAC_OVERRIDE"
capabilities="${capabilities},CAP_MKNOD"
capabilities="${capabilities},CAP_NET_ADMIN"
capabilities="${capabilities},CAP_NET_BIND_SERVICE"
capabilities="${capabilities},CAP_NET_BROADCAST"
capabilities="${capabilities},CAP_NET_RAW"
capabilities="${capabilities},CAP_SETGID"
capabilities="${capabilities},CAP_SETFCAP"
capabilities="${capabilities},CAP_SETPCAP"
capabilities="${capabilities},CAP_SETUID"
capabilities="${capabilities},CAP_SYS_ADMIN"
capabilities="${capabilities},CAP_SYS_BOOT"
capabilities="${capabilities},CAP_SYS_CHROOT"
capabilities="${capabilities},CAP_SYS_MODULE"
capabilities="${capabilities},CAP_SYS_NICE"
capabilities="${capabilities},CAP_SYS_PACCT"
capabilities="${capabilities},CAP_SYS_PTRACE"
capabilities="${capabilities},CAP_SYS_RAWIO"
capabilities="${capabilities},CAP_SYS_RESOURCE"
capabilities="${capabilities},CAP_SYS_TIME"
capabilities="${capabilities},CAP_SYS_TTY_CONFIG"
capabilities="${capabilities},CAP_SYSLOG"
capabilities="${capabilities},CAP_WAKE_ALARM"


/usr/sbin/setcap "${capabilities}=eip" "${1}"
